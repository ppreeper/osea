

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>How to Monitor Redis Server with Prometheus and Grafana in 5 minutes &#8212; Enterprise Architecture  documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Monitoring Ceph Cluster with Prometheus and Grafana" href="Monitoring Ceph Cluster with Prometheus and Grafana.html" />
    <link rel="prev" title="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes" href="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Monitoring Ceph Cluster with Prometheus and Grafana.html" title="Monitoring Ceph Cluster with Prometheus and Grafana"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes.html" title="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Enterprise Architecture  documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">How to Monitor Redis Server with Prometheus and Grafana in 5 minutes</a><ul>
<li><a class="reference internal" href="#step-1-download-and-install-redis-prometheus-exporter">Step 1: Download and Install Redis Prometheus exporter</a></li>
<li><a class="reference internal" href="#step-2-create-prometheus-redis-exporter-systemd-service-init-script">Step 2: Create Prometheus redis exporter systemd service / Init script</a><ul>
<li><a class="reference internal" href="#for-init-system">For Init system</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-3-start-redis-prometheus-exporter-and-enable-service-to-start-on-boot">Step 3: Start Redis Prometheus exporter and enable service to start on boot</a></li>
<li><a class="reference internal" href="#step-4-add-exporter-job-to-prometheus">Step 4: Add exporter job to Prometheus</a></li>
<li><a class="reference internal" href="#step-5-add-dashboard-to-grafana">Step 5: Add Dashboard to Grafana</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes.html"
                        title="previous chapter">How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Monitoring Ceph Cluster with Prometheus and Grafana.html"
                        title="next chapter">Monitoring Ceph Cluster with Prometheus and Grafana</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/doc/How to Monitor Redis Server with Prometheus and Grafana in 5 minutes.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-monitor-redis-server-with-prometheus-and-grafana-in-5-minutes">
<h1>How to Monitor Redis Server with Prometheus and Grafana in 5 minutes<a class="headerlink" href="#how-to-monitor-redis-server-with-prometheus-and-grafana-in-5-minutes" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://computingforgeeks.com/how-to-monitor-redis-server-with-prometheus-and-grafana-in-5-minutes/">https://computingforgeeks.com/how-to-monitor-redis-server-with-prometheus-and-grafana-in-5-minutes/</a></p>
<p>(Last Updated On: September 24, 2018)</p>
<p>This guide will focus on monitoring of Redis application on a Linux server.
Redis is an open source in-memory data structure store, used as a database,
cache and message broker. Redis provides a distributed, in-memory key-value
database with optional durability.</p>
<p>Redis supports different kinds of abstract data structures, such as strings,
sets, maps, lists, sorted sets, spatial indexes, and bitmaps.</p>
<p>So far we have covered the following monitoring with Prometheus:</p>
<ul class="simple">
<li><p>Monitoring Ceph Cluster with Prometheus and Grafana</p></li>
<li><p>How to Monitor Linux Server Performance with Prometheus and Grafana in 5
minutes</p></li>
<li><p>How to Monitor BIND DNS server with Prometheus and Grafana</p></li>
<li><p>Monitoring MySQL / MariaDB with Prometheus in five minutes</p></li>
<li><p>How to Monitor Apache Web Server with Prometheus and Grafana in 5 minutes</p></li>
</ul>
<p>## What’s exported by Redis exporter?</p>
<p>Most items from the INFO command are exported, see
<a class="reference external" href="http://redis.io/commands/info">http://redis.io/commands/info</a> for details. In addition, for every database
there are metrics for total keys, expiring keys and the average TTL for
keys in the database.</p>
<p>You can also export values of keys if they’re in numeric format by using
the -check-keys flag. The exporter will also export the size (or, depending
on the data type, the length) of the key. This can be used to export the
number of elements in (sorted) sets, hashes, lists, etc.</p>
<p>## Setup Pre-requisite</p>
<ol class="arabic simple">
<li><p>Installed Prometheus Server – Install Prometheus Server on CentOS 7 and
Ubuntu 18.04</p></li>
<li><p>Installed Grafana Data visualization &amp; Monitoring – Install Prometheus
Server on CentOS 7 and Ubuntu 18.04</p></li>
</ol>
<div class="section" id="step-1-download-and-install-redis-prometheus-exporter">
<h2>Step 1: Download and Install Redis Prometheus exporter<a class="headerlink" href="#step-1-download-and-install-redis-prometheus-exporter" title="Permalink to this headline">¶</a></h2>
<p>This Prometheus exporter for Redis metrics supports Redis 2.x, 3.x, and 4.x</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export VER=&quot;0.21.2&quot;
wget https://github.com/oliver006/redis_exporter/releases/download/v${VER}/redis_exporter-v${VER}.linux-amd64.tar.gz
</pre></div>
</div>
<p>Extract the downloaded archive file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tar xvf redis_exporter-v${VER}.linux-amd64.tar.gz
sudo mv redis_exporter /usr/local/bin/
rm -f redis_exporter-v${VER}.linux-amd64.tar.gz
</pre></div>
</div>
<p><cite>redis_exporter</cite> should be executable from your current SHELL</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ redis_exporter  -version
INFO[0000] Redis Metrics Exporter v0.21.2    build date: 2018-09-20-18:15:12    sha1: 8bb0b841e9a70b0348f69483e58fea01d521c47a    Go: go1.10.4
</pre></div>
</div>
<p>To get a list of all options supported, pass <cite>–help</cite> option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># redis_exporter  --help</span>
<span class="n">Usage</span> <span class="n">of</span> <span class="n">redis_exporter</span><span class="p">:</span>
<span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">keys</span> <span class="n">string</span>
        <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">key</span><span class="o">-</span><span class="n">patterns</span> <span class="n">to</span> <span class="n">export</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">length</span><span class="o">/</span><span class="n">size</span><span class="p">,</span> <span class="n">searched</span> <span class="k">for</span> <span class="k">with</span> <span class="n">SCAN</span>
<span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">single</span><span class="o">-</span><span class="n">keys</span> <span class="n">string</span>
        <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">single</span> <span class="n">keys</span> <span class="n">to</span> <span class="n">export</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">length</span><span class="o">/</span><span class="n">size</span>
<span class="o">-</span><span class="n">debug</span>
        <span class="n">Output</span> <span class="n">verbose</span> <span class="n">debug</span> <span class="n">information</span>
<span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="nb">format</span> <span class="n">string</span>
        <span class="n">Log</span> <span class="nb">format</span><span class="p">,</span> <span class="n">valid</span> <span class="n">options</span> <span class="n">are</span> <span class="n">txt</span> <span class="ow">and</span> <span class="n">json</span> <span class="p">(</span><span class="n">default</span> <span class="s2">&quot;txt&quot;</span><span class="p">)</span>
<span class="o">-</span><span class="n">namespace</span> <span class="n">string</span>
        <span class="n">Namespace</span> <span class="k">for</span> <span class="n">metrics</span> <span class="p">(</span><span class="n">default</span> <span class="s2">&quot;redis&quot;</span><span class="p">)</span>
<span class="o">-</span><span class="n">redis</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="n">metrics</span>
        <span class="n">Whether</span> <span class="n">to</span> <span class="n">export</span> <span class="n">go</span> <span class="n">runtime</span> <span class="n">metrics</span> <span class="n">also</span>
<span class="o">-</span><span class="n">redis</span><span class="o">.</span><span class="n">addr</span> <span class="n">string</span>
        <span class="n">Address</span> <span class="n">of</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">redis</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">separator</span>
<span class="o">-</span><span class="n">redis</span><span class="o">.</span><span class="n">alias</span> <span class="n">string</span>
        <span class="n">Redis</span> <span class="n">instance</span> <span class="n">alias</span> <span class="k">for</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">redis</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">separator</span>
<span class="o">-</span><span class="n">redis</span><span class="o">.</span><span class="n">file</span> <span class="n">string</span>
        <span class="n">Path</span> <span class="n">to</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">redis</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">newline</span><span class="o">.</span> <span class="n">NOTE</span><span class="p">:</span> <span class="n">mutually</span> <span class="n">exclusive</span> <span class="k">with</span> <span class="n">redis</span><span class="o">.</span><span class="n">addr</span>
<span class="o">-</span><span class="n">redis</span><span class="o">.</span><span class="n">password</span> <span class="n">string</span>
        <span class="n">Password</span> <span class="k">for</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">redis</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">separator</span>
<span class="o">-</span><span class="n">script</span> <span class="n">string</span>
        <span class="n">Path</span> <span class="n">to</span> <span class="n">Lua</span> <span class="n">Redis</span> <span class="n">script</span> <span class="k">for</span> <span class="n">collecting</span> <span class="n">extra</span> <span class="n">metrics</span>
<span class="o">-</span><span class="n">separator</span> <span class="n">string</span>
        <span class="n">separator</span> <span class="n">used</span> <span class="n">to</span> <span class="n">split</span> <span class="n">redis</span><span class="o">.</span><span class="n">addr</span><span class="p">,</span> <span class="n">redis</span><span class="o">.</span><span class="n">password</span> <span class="ow">and</span> <span class="n">redis</span><span class="o">.</span><span class="n">alias</span> <span class="n">into</span> <span class="n">several</span> <span class="n">elements</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="o">-</span><span class="n">use</span><span class="o">-</span><span class="n">cf</span><span class="o">-</span><span class="n">bindings</span>
        <span class="n">Use</span> <span class="n">Cloud</span> <span class="n">Foundry</span> <span class="n">service</span> <span class="n">bindings</span>
<span class="o">-</span><span class="n">version</span>
        <span class="n">Show</span> <span class="n">version</span> <span class="n">information</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">-</span><span class="n">web</span><span class="o">.</span><span class="n">listen</span><span class="o">-</span><span class="n">address</span> <span class="n">string</span>
        <span class="n">Address</span> <span class="n">to</span> <span class="n">listen</span> <span class="n">on</span> <span class="k">for</span> <span class="n">web</span> <span class="n">interface</span> <span class="ow">and</span> <span class="n">telemetry</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span> <span class="s2">&quot;:9121&quot;</span><span class="p">)</span>
<span class="o">-</span><span class="n">web</span><span class="o">.</span><span class="n">telemetry</span><span class="o">-</span><span class="n">path</span> <span class="n">string</span>
        <span class="n">Path</span> <span class="n">under</span> <span class="n">which</span> <span class="n">to</span> <span class="n">expose</span> <span class="n">metrics</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span> <span class="s2">&quot;/metrics&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="step-2-create-prometheus-redis-exporter-systemd-service-init-script">
<h2>Step 2: Create Prometheus redis exporter systemd service / Init script<a class="headerlink" href="#step-2-create-prometheus-redis-exporter-systemd-service-init-script" title="Permalink to this headline">¶</a></h2>
<p>The user <cite>prometheus</cite> will be used to run the service. Add <cite>prometheus</cite> system
user if it doesn’t exist</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">groupadd</span> <span class="o">--</span><span class="n">system</span> <span class="n">prometheus</span>
<span class="n">sudo</span> <span class="n">useradd</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span> <span class="o">--</span><span class="n">system</span> <span class="o">-</span><span class="n">g</span> <span class="n">prometheus</span> <span class="n">prometheus</span>
</pre></div>
</div>
<p>Then proceed to create a systemd service unit file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">vim</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">redis_exporter</span><span class="o">.</span><span class="n">service</span>
</pre></div>
</div>
<p>Add below content</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Unit]
Description=Prometheus
Documentation=https://github.com/oliver006/redis_exporter
Wants=network-online.target
After=network-online.target

[Service]
Type=simple
User=prometheus
Group=prometheus
ExecReload=/bin/kill -HUP $MAINPID
ExecStart=/usr/local/bin/redis_exporter \
--log-format=txt \
--namespace=redis \
--web.listen-address=:9121 \
--web.telemetry-path=/metrics

SyslogIdentifier=redis_exporter
Restart=always

[Install]
WantedBy=multi-user.target
</pre></div>
</div>
<div class="section" id="for-init-system">
<h3>For Init system<a class="headerlink" href="#for-init-system" title="Permalink to this headline">¶</a></h3>
<p>Install <cite>daemonize</cite> ( CentOS / Ubuntu )</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">daemonize</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">daemonize</span>
</pre></div>
</div>
<p>Create init script</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">vim</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">redis_exporter</span>
</pre></div>
</div>
<p>Add</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
# Author: Josphat Mutai, kiplangatmtai@gmail.com , https://github.com/jmutai
# redis_exporter     This shell script takes care of starting and stopping Prometheus redis exporter
#
# chkconfig: 2345 80 80
# description: Prometheus redis exporter  start script
# processname: redis_exporter
# pidfile: /var/run/redis_exporter.pid

# Source function library.
. /etc/rc.d/init.d/functions

RETVAL=0
PROGNAME=redis_exporter
PROG=/usr/local/bin/${PROGNAME}
RUNAS=prometheus
LOCKFILE=/var/lock/subsys/${PROGNAME}
PIDFILE=/var/run/${PROGNAME}.pid
LOGFILE=/var/log/${PROGNAME}.log
DAEMON_SYSCONFIG=/etc/sysconfig/${PROGNAME}

# GO CPU core Limit

#GOMAXPROCS=$(grep -c ^processor /proc/cpuinfo)
GOMAXPROCS=1

# Source config

. ${DAEMON_SYSCONFIG}

start() {
    if [[ -f $PIDFILE ]] &gt; /dev/null; then
        echo &quot;redis_exporter  is already running&quot;
        exit 0
    fi

    echo -n &quot;Starting redis_exporter  service…&quot;
    daemonize -u ${USER} -p ${PIDFILE} -l ${LOCKFILE} -a -e ${LOGFILE} -o ${LOGFILE} ${PROG} ${ARGS}
    RETVAL=$?
    echo &quot;&quot;
    return $RETVAL
}

stop() {
    if [ ! -f &quot;$PIDFILE&quot; ] || ! kill -0 $(cat &quot;$PIDFILE&quot;); then
        echo &quot;Service not running&quot;
        return 1
    fi
    echo &#39;Stopping service…&#39;
    #kill -15 $(cat &quot;$PIDFILE&quot;) &amp;&amp; rm -f &quot;$PIDFILE&quot;
    killproc -p ${PIDFILE} -d 10 ${PROG}
    RETVAL=$?
    echo
    [ $RETVAL = 0 ] &amp;&amp; rm -f ${LOCKFILE} ${PIDFILE}
    return $RETVAL
}

status() {
    if [ -f &quot;$PIDFILE&quot; ] || kill -0 $(cat &quot;$PIDFILE&quot;); then
    echo &quot;redis exporter  service running...&quot;
    echo &quot;Service PID: `cat $PIDFILE`&quot;
    else
    echo &quot;Service not running&quot;
    fi
    RETVAL=$?
    return $RETVAL
}

# Call function
case &quot;$1&quot; in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart)
        stop
        start
        ;;
    status)
        status
        ;;
    *)
        echo &quot;Usage: $0 {start|stop|restart}&quot;
        exit 2
esac
</pre></div>
</div>
<p>Create Arguments configuration file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">vim</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">redis_exporter</span>
</pre></div>
</div>
<p>Define used command Arguments</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ARGS</span><span class="o">=</span><span class="s2">&quot;--log-format=txt </span><span class="se">\</span>
<span class="s2">--namespace=redis </span><span class="se">\</span>
<span class="s2">--web.listen-address=:9121 </span><span class="se">\</span>
<span class="s2">--web.telemetry-path=/metrics&quot;</span>
</pre></div>
</div>
<p>Test the script</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># /etc/init.d/redis_exporter</span>
<span class="n">Usage</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">redis_exporter</span> <span class="p">{</span><span class="n">start</span><span class="o">|</span><span class="n">stop</span><span class="o">|</span><span class="n">restart</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-3-start-redis-prometheus-exporter-and-enable-service-to-start-on-boot">
<h2>Step 3: Start Redis Prometheus exporter and enable service to start on boot<a class="headerlink" href="#step-3-start-redis-prometheus-exporter-and-enable-service-to-start-on-boot" title="Permalink to this headline">¶</a></h2>
<p>For a Systemd server, use <cite>systemctl</cite> command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">redis_exporter</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">redis_exporter</span>
</pre></div>
</div>
<p>For SysV Init system, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">redis_exporter</span> <span class="n">start</span>
<span class="n">sudo</span> <span class="n">chkconfig</span> <span class="n">redis_exporter</span> <span class="n">on</span>
</pre></div>
</div>
<p>You can verify that the service is running using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo /etc/init.d/redis_exporter status
redis exporter  service running...
Service PID: 27106

$ sudo chkconfig --list | grep redis_exporter
redis_exporter 0:off   1:off   2:on    3:on    4:on    5:on    6:off

$ sudo ss -tunelp | grep 9121
tcp    LISTEN     0      128                   :::9121                 :::*      users:((&quot;redis_exporter&quot;,1970,6)) ino:1823474168 sk:ffff880341cd7800
</pre></div>
</div>
</div>
<div class="section" id="step-4-add-exporter-job-to-prometheus">
<h2>Step 4: Add exporter job to Prometheus<a class="headerlink" href="#step-4-add-exporter-job-to-prometheus" title="Permalink to this headline">¶</a></h2>
<p>The last step is to add a job to the Prometheus server for scraping metrics.
Edit <cite>/etc/prometheus/prometheus.yml</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Redis Servers</span>
<span class="o">-</span> <span class="n">job_name</span><span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.3</span><span class="o">-</span><span class="n">redis</span>
    <span class="n">static_configs</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">targets</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;10.10.10.3:9121&#39;</span><span class="p">]</span>
        <span class="n">labels</span><span class="p">:</span>
        <span class="n">alias</span><span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.3</span>

<span class="o">-</span> <span class="n">job_name</span><span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.4</span><span class="o">-</span><span class="n">redis</span>
    <span class="n">static_configs</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">targets</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;10.10.10.4:9121&#39;</span><span class="p">]</span>
        <span class="n">labels</span><span class="p">:</span>
        <span class="n">alias</span><span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.4</span>
</pre></div>
</div>
<p>Restart prometheus service for scraping of data metrics to begin</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">prometheus</span>
</pre></div>
</div>
<p>Test access to port <cite>9121</cite> from Prometheus server, it should be able to
connect.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ telnet 10.1.10.15 9121
Trying 10.1.10.15...
Connected to 10.1.10.15.
Escape character is &#39;^]&#39;.
^]
</pre></div>
</div>
<p>If it can’t connect, check your Service port and firewall.</p>
</div>
<div class="section" id="step-5-add-dashboard-to-grafana">
<h2>Step 5: Add Dashboard to Grafana<a class="headerlink" href="#step-5-add-dashboard-to-grafana" title="Permalink to this headline">¶</a></h2>
<p>Add Prometheus data source to Grafana and import or create a grafana
dashboard for Redis.</p>
<p>Grafana dashboard is available on <a class="reference external" href="https://grafana.net/dashboards/763">https://grafana.net/dashboards/763</a>
grafana.net and/or <a class="reference external" href="https://github.com/oliver006/redis_exporter/blob/master/contrib/grafana_prometheus_redis_dashboard.json">https://github.com/oliver006/redis_exporter/blob/master/contrib/grafana_prometheus_redis_dashboard.json</a>
github.com . My Job configuration uses an <em>alias</em>, I’ll use Grafana dashboard
with <em>host &amp; alias</em> selector is available on <a class="reference external" href="https://github.com/oliver006/redis_exporter/blob/master/contrib/grafana_prometheus_redis_dashboard_alias.json">https://github.com/oliver006/redis_exporter/blob/master/contrib/grafana_prometheus_redis_dashboard_alias.json</a>
github.com.</p>
<p>Download the dashboard <cite>json</cite> file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">oliver006</span><span class="o">/</span><span class="n">redis_exporter</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">contrib</span><span class="o">/</span><span class="n">grafana_prometheus_redis_dashboard_alias</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>On Grafana UI, go to <cite>Create &gt; Import Dashboard &gt; Upload .json</cite> File. Select
downloaded json file and click “<em>Import</em>“.</p>
<p>image:https://computingforgeeks.com/wp-content/uploads/2018/09/prometheus-redis-import-dashboard-min-696x324.png[]</p>
<p>Wait for data to start appearing on your Grafana Dashboard, below is a
sample view</p>
<p>image:https://computingforgeeks.com/wp-content/uploads/2018/09/prometheus-redis-dashboard-min-696x299.png[]</p>
<p>Enjoy using Grafana to monitor your Redis server(s).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Monitoring Ceph Cluster with Prometheus and Grafana.html" title="Monitoring Ceph Cluster with Prometheus and Grafana"
             >next</a> |</li>
        <li class="right" >
          <a href="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes.html" title="How to Monitor Linux Server Performance with Prometheus and Grafana in 5 minutes"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Enterprise Architecture  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Peter Preeper.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>